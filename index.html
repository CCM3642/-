<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crispy Chicken - Complaints Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Enhanced styles */
        :root {
            --crispy-red: #d32f2f;
            --crispy-dark: #b71c1c;
            --crispy-light: #ffcdd2;
            --bg-light: #fafafa;
            --bg-dark: #f5f5f5;
            --text-primary: #333;
            --text-secondary: #666;
            --noon-color: #FFB800;
            --careem-color: #00A86B;
            --whatsapp-color: #25D366;
            --email-color: #007bff;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-primary);
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        
        /* Animated background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(211, 47, 47, 0.05) 0%, rgba(255, 184, 0, 0.05) 100%);
            z-index: -1;
            animation: gradientShift 15s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background: linear-gradient(135deg, rgba(211, 47, 47, 0.05) 0%, rgba(255, 184, 0, 0.05) 100%); }
            50% { background: linear-gradient(135deg, rgba(255, 184, 0, 0.05) 0%, rgba(0, 168, 107, 0.05) 100%); }
        }
        
        .navbar {
            background: linear-gradient(135deg, var(--crispy-red) 0%, var(--crispy-dark) 100%);
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.8rem;
            color: white !important;
            display: flex;
            align-items: center;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .navbar-brand i {
            margin-right: 10px;
            font-size: 2.2rem;
        }
        
        .container {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 25px;
            background-color: white;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }
        
        .card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--crispy-red), var(--noon-color), var(--careem-color));
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.6s ease;
        }
        
        .card:hover::before {
            transform: scaleX(1);
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--crispy-red) 0%, var(--crispy-dark) 100%);
            color: white;
            font-weight: 600;
            padding: 20px 25px;
            border: none;
            position: relative;
            overflow: hidden;
        }
        
        .card-header::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transform: rotate(45deg);
        }
        
        .btn-crispy {
            background-color: var(--crispy-red);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(211, 47, 47, 0.3);
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .btn-crispy::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.5s;
        }
        
        .btn-crispy:hover::before {
            left: 100%;
        }
        
        .btn-crispy:hover {
            background-color: var(--crispy-dark);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(211, 47, 47, 0.4);
        }
        
        .btn-email {
            background: linear-gradient(135deg, var(--email-color), #0056b3);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,123,255,0.3);
            display: inline-flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-email:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,123,255,0.4);
        }
        
        .btn-whatsapp {
            background: linear-gradient(135deg, var(--whatsapp-color), #128C7E);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(37,211,102,0.3);
            display: inline-flex;
            align-items: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-whatsapp:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(37,211,102,0.4);
        }
        
        .btn-whatsapp .status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-left: 5px;
            animation: blink 1.5s infinite;
        }
        
        .btn-whatsapp .status.online {
            background-color: #25D366;
        }
        
        .btn-whatsapp .status.offline {
            background-color: #999;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        .stats-card {
            border-left: 5px solid var(--crispy-red);
            padding: 25px;
            background-color: white;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .stats-card::before {
            content: '';
            position: absolute;
            top: -10px;
            right: -10px;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            border-radius: 50%;
        }
        
        .stats-card:hover {
            transform: translateX(10px) scale(1.03);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }
        
        .stats-card h3 {
            font-size: 3rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
        }
        
        .stats-card p {
            margin: 10px 0 0;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 1.1rem;
            position: relative;
            z-index: 1;
        }
        
        .stats-card.total h3 { color: var(--crispy-red); }
        .stats-card.open h3 { color: #0d47a1; }
        .stats-card.sent h3 { color: #ff8f00; }
        .stats-card.closed h3 { color: #2e7d32; }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        .platform-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .platform-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .platform-card::after {
            content: '';
            position: absolute;
            bottom: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transform: rotate(45deg);
            transition: all 0.6s ease;
        }
        
        .platform-card:hover {
            transform: translateY(-15px) scale(1.05);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }
        
        .platform-card:hover::after {
            top: -50%;
            left: -50%;
        }
        
        .platform-card.noon {
            border-color: var(--noon-color);
        }
        
        .platform-card.careem {
            border-color: var(--careem-color);
        }
        
        .platform-card h3 {
            font-size: 3.5rem;
            font-weight: 800;
            margin: 20px 0;
            position: relative;
            z-index: 1;
        }
        
        .platform-card.noon h3 {
            color: var(--noon-color);
        }
        
        .platform-card.careem h3 {
            color: var(--careem-color);
        }
        
        .platform-card .platform-icon {
            font-size: 5rem;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }
        
        .platform-card.noon .platform-icon {
            color: var(--noon-color);
        }
        
        .platform-card.careem .platform-icon {
            color: var(--careem-color);
        }
        
        .platform-card .percentage {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-secondary);
            margin-top: 15px;
            position: relative;
            z-index: 1;
        }
        
        .table {
            color: var(--text-primary);
        }
        
        .table th {
            background-color: var(--crispy-light);
            color: var(--crispy-dark);
            font-weight: 700;
            border: none;
            padding: 18px 15px;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .table td {
            vertical-align: middle;
            border-color: #e0e0e0;
            padding: 18px 15px;
            transition: all 0.3s ease;
        }
        
        .table tbody tr {
            transition: all 0.3s ease;
        }
        
        .table tbody tr:hover {
            background-color: rgba(211, 47, 47, 0.05);
            transform: scale(1.01);
        }
        
        .badge {
            font-weight: 600;
            padding: 10px 18px;
            border-radius: 25px;
            font-size: 0.9rem;
        }
        
        .badge-open {
            background-color: #e3f2fd;
            color: #0d47a1;
            box-shadow: 0 2px 5px rgba(13, 71, 161, 0.2);
        }
        
        .badge-sent {
            background-color: #fff8e1;
            color: #ff8f00;
            box-shadow: 0 2px 5px rgba(255, 143, 0, 0.2);
        }
        
        .badge-closed {
            background-color: #e8f5e9;
            color: #2e7d32;
            box-shadow: 0 2px 5px rgba(46, 125, 50, 0.2);
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .action-buttons button {
            border-radius: 10px;
            padding: 10px 18px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }
        
        .action-buttons button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .action-buttons button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .action-buttons button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }
        
        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            padding: 12px 18px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--crispy-red);
            box-shadow: 0 0 0 0.25rem rgba(211, 47, 47, 0.25);
        }
        
        .form-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: white;
            padding: 35px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            z-index: 1000;
            width: 90%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            border: 3px solid var(--crispy-light);
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .form-popup.show {
            display: block;
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
        
        .form-popup h3 {
            margin-top: 0;
            color: var(--crispy-red);
            border-bottom: 3px solid var(--crispy-light);
            padding-bottom: 15px;
            font-weight: 700;
        }
        
        .form-popup label {
            font-weight: 600;
            margin-bottom: 10px;
            display: block;
            color: var(--text-primary);
        }
        
        .form-popup input, .form-popup select, .form-popup textarea {
            width: 100%;
            padding: 12px 18px;
            margin-bottom: 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .form-popup textarea {
            height: 120px;
            resize: vertical;
            min-height: 100px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .save-btn {
            background: linear-gradient(135deg, var(--crispy-red), var(--crispy-dark));
            color: white;
            border: none;
            border-radius: 10px;
            padding: 15px 35px;
            width: 100%;
            font-weight: 700;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(211, 47, 47, 0.3);
            cursor: pointer;
        }
        
        .save-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(211, 47, 47, 0.4);
        }
        
        .evidence-section {
            margin: 25px 0;
            padding: 25px;
            border: 3px dashed var(--crispy-light);
            border-radius: 15px;
            background-color: #f8f9fa;
            transition: all 0.3s ease;
        }
        
        .evidence-section:hover {
            border-color: var(--crispy-red);
            background-color: rgba(211, 47, 47, 0.05);
        }
        
        .evidence-section h5 {
            color: var(--crispy-red);
            margin-bottom: 20px;
            font-weight: 700;
            font-size: 1.3rem;
        }
        
        .file-drop-area {
            border: 3px dashed #ced4da;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: white;
            margin-bottom: 20px;
        }
        
        .file-drop-area:hover {
            border-color: var(--crispy-red);
            background-color: var(--crispy-light);
            transform: scale(1.02);
        }
        
        .file-drop-area.drag-over {
            border-color: var(--crispy-red);
            background-color: rgba(211, 47, 47, 0.1);
            transform: scale(1.05);
        }
        
        .file-input {
            display: none;
        }
        
        .file-list {
            margin-top: 20px;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 18px;
            background-color: #f8f9fa;
            border-radius: 12px;
            margin-bottom: 15px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
        }
        
        .file-item:hover {
            border-color: var(--crispy-red);
            transform: translateX(8px);
        }
        
        .file-item i {
            color: var(--crispy-red);
            margin-right: 15px;
            font-size: 1.3rem;
        }
        
        .file-item button {
            background: none;
            border: none;
            color: var(--crispy-red);
            cursor: pointer;
            font-size: 20px;
            transition: all 0.2s ease;
            padding: 5px;
        }
        
        .file-item button:hover {
            transform: scale(1.2);
            color: var(--crispy-dark);
        }
        
        .evidence-link {
            color: var(--email-color);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        
        .evidence-link:hover {
            text-decoration: underline;
            transform: translateX(5px);
        }
        
        .evidence-none {
            color: var(--text-secondary);
            font-style: italic;
        }
        
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 25px 30px;
            background-color: white;
            border-left: 5px solid var(--crispy-red);
            border-radius: 15px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            z-index: 1001;
            transform: translateX(200%) rotate(5deg);
            transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 400px;
            border: 2px solid var(--crispy-light);
        }
        
        .notification.show {
            transform: translateX(0) rotate(0);
        }
        
        .notification i {
            margin-right: 15px;
            color: var(--crispy-red);
            font-size: 1.8rem;
        }
        
        .footer {
            background-color: var(--crispy-dark);
            color: white;
            padding: 40px 0;
            margin-top: 60px;
            text-align: center;
            border-radius: 20px 20px 0 0;
            position: relative;
            overflow: hidden;
        }
        
        .footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--crispy-red), var(--noon-color), var(--careem-color));
        }
        
        .filter-section {
            background-color: white;
            border-radius: 20px;
            padding: 35px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 3px solid var(--crispy-light);
        }
        
        .filter-section h5 {
            color: var(--crispy-red);
            margin-bottom: 30px;
            font-weight: 700;
            font-size: 1.4rem;
            border-bottom: 3px solid var(--crispy-light);
            padding-bottom: 15px;
        }
        
        .filter-section .row {
            margin-bottom: 30px;
        }
        
        .filter-section .form-label {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }
        
        .filter-section button {
            margin-right: 15px;
            border-radius: 10px;
            padding: 12px 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        
        .filter-section button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        .table-responsive {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 3px solid var(--crispy-light);
        }
        
        .table thead th {
            background-color: var(--crispy-light);
            color: var(--crispy-dark);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .empty-state {
            text-align: center;
            padding: 80px 50px;
            color: var(--text-secondary);
            border-radius: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 3px dashed var(--crispy-light);
        }
        
        .empty-state i {
            font-size: 5rem;
            color: var(--crispy-light);
            margin-bottom: 30px;
        }
        
        .empty-state h5 {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--text-primary);
        }
        
        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.5rem;
            }
            
            .navbar-brand i {
                font-size: 1.8rem;
            }
            
            .stats-card h3 {
                font-size: 2.5rem;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-buttons button {
                margin-bottom: 10px;
                width: 100%;
            }
            
            .form-popup {
                width: 95%;
                padding: 25px;
                max-height: 95vh;
            }
            
            .filter-section {
                padding: 25px;
            }
            
            .filter-section button {
                margin-right: 10px;
                margin-bottom: 10px;
                width: 100%;
            }
            
            .platform-stats {
                grid-template-columns: 1fr;
            }
            
            .table-responsive {
                font-size: 0.9rem;
            }
            
            .table th, .table td {
                padding: 12px 10px;
            }
        }
        
        /* Animation for new tickets */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .new-ticket-row {
            animation: slideIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        /* Pulse animation for important buttons */
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(211, 47, 47, 0.7);
            }
            70% {
                box-shadow: 0 0 0 15px rgba(211, 47, 47, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(211, 47, 47, 0);
            }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        /* Fixed textarea height */
        .form-popup textarea {
            min-height: 100px;
            max-height: 200px;
            overflow-y: auto;
        }
        
        /* Fixed form popup height */
        .form-popup {
            max-height: 90vh;
            overflow-y: auto;
        }
        
        /* Fixed WhatsApp and Email button functionality */
        .btn-email, .btn-whatsapp {
            cursor: pointer;
        }
        
        /* Fixed table layout */
        .table {
            table-layout: fixed;
        }
        
        .table th:nth-child(5), .table td:nth-child(5) {
            width: 20%;
            word-wrap: break-word;
        }
        
        .table th:nth-child(6), .table td:nth-child(6) {
            width: 15%;
            word-wrap: break-word;
        }
        
        /* Form overlay */
        .form-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: 999;
            backdrop-filter: blur(5px);
        }
        
        .form-overlay.show {
            display: block;
        }
        
        /* Enhanced styles for new features */
        .help-section {
            background-color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 3px solid var(--crispy-light);
        }
        
        .help-section h5 {
            color: var(--crispy-red);
            margin-bottom: 25px;
            font-weight: 700;
            font-size: 1.4rem;
            border-bottom: 3px solid var(--crispy-light);
            padding-bottom: 15px;
        }
        
        .help-item {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 15px;
            background-color: #f8f9fa;
            transition: all 0.4s ease;
        }
        
        .help-item:hover {
            background-color: var(--crispy-light);
            transform: translateX(10px);
        }
        
        .help-item i {
            font-size: 1.8rem;
            color: var(--crispy-red);
            margin-right: 20px;
        }
        
        .help-item h6 {
            margin: 0;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .help-item p {
            margin: 8px 0 0 0;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        .quick-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .quick-stat {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.4s ease;
            border: 3px solid var(--crispy-light);
            flex: 1;
            min-width: 180px;
            margin: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .quick-stat::before {
            content: '';
            position: absolute;
            top: -20px;
            right: -20px;
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
            border-radius: 50%;
        }
        
        .quick-stat:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .quick-stat h6 {
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--text-secondary);
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .quick-stat .value {
            font-size: 3rem;
            font-weight: 800;
            margin: 0;
            position: relative;
            z-index: 1;
        }
        
        .quick-stat .value.open {
            color: #0d47a1;
        }
        
        .quick-stat .value.sent {
            color: #ff8f00;
        }
        
        .quick-stat .value.closed {
            color: #2e7d32;
        }
        
        .quick-stat .value.total {
            color: var(--crispy-red);
        }
        
        .recent-tickets {
            background-color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 3px solid var(--crispy-light);
        }
        
        .recent-tickets h5 {
            color: var(--crispy-red);
            margin-bottom: 25px;
            font-weight: 700;
            font-size: 1.4rem;
            border-bottom: 3px solid var(--crispy-light);
            padding-bottom: 15px;
        }
        
        .recent-ticket-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-radius: 15px;
            background-color: #f8f9fa;
            margin-bottom: 20px;
            transition: all 0.4s ease;
        }
        
        .recent-ticket-item:hover {
            background-color: var(--crispy-light);
            transform: translateX(15px);
        }
        
        .recent-ticket-info h6 {
            margin: 0;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .recent-ticket-info p {
            margin: 8px 0 0;
            color: var(--text-secondary);
            font-size: 0.95rem;
        }
        
        .recent-ticket-status {
            font-size: 0.9rem;
            font-weight: 700;
            padding: 8px 15px;
            border-radius: 25px;
        }
        
        .recent-ticket-status.open {
            background-color: #e3f2fd;
            color: #0d47a1;
        }
        
        .recent-ticket-status.sent {
            background-color: #fff8e1;
            color: #ff8f00;
        }
        
        .recent-ticket-status.closed {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .communication-panel {
            background-color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 3px solid var(--crispy-light);
        }
        
        .communication-panel h5 {
            color: var(--crispy-red);
            margin-bottom: 25px;
            font-weight: 700;
            font-size: 1.4rem;
            border-bottom: 3px solid var(--crispy-light);
            padding-bottom: 15px;
        }
        
        .communication-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 25px;
        }
        
        .comm-stat {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            background-color: #f8f9fa;
            transition: all 0.3s ease;
            flex: 1;
            margin: 0 10px;
        }
        
        .comm-stat:hover {
            transform: translateY(-5px);
            background-color: var(--crispy-light);
        }
        
        .comm-stat i {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .comm-stat.whatsapp i {
            color: var(--whatsapp-color);
        }
        
        .comm-stat.email i {
            color: var(--email-color);
        }
        
        .comm-stat h6 {
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--text-primary);
        }
        
        .comm-stat p {
            color: var(--text-secondary);
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .chart-tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 25px;
        }
        
        .chart-tab {
            padding: 12px 25px;
            margin: 0 5px;
            background-color: #f8f9fa;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .chart-tab.active {
            background-color: var(--crispy-light);
            color: var(--crispy-dark);
        }
        
        .chart-tab:hover {
            background-color: var(--crispy-light);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-fire"></i>
                Crispy Chicken Complaints Dashboard
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="bi bi-speedometer2"></i> Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-list-task"></i> Tickets</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-graph-up"></i> Analytics</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Main Content -->
    <div class="container">
        <!-- Quick Stats -->
        <div class="quick-stats">
            <div class="quick-stat">
                <h6>Total Tickets</h6>
                <p class="value total" id="quickTotal">0</p>
            </div>
            <div class="quick-stat">
                <h6>Open</h6>
                <p class="value open" id="quickOpen">0</p>
            </div>
            <div class="quick-stat">
                <h6>Sent</h6>
                <p class="value sent" id="quickSent">0</p>
            </div>
            <div class="quick-stat">
                <h6>Closed</h6>
                <p class="value closed" id="quickClosed">0</p>
            </div>
        </div>
        
        <!-- Communication Panel -->
        <div class="communication-panel">
            <h5><i class="bi bi-chat-dots"></i> Communication Analytics</h5>
            <div class="communication-stats">
                <div class="comm-stat whatsapp">
                    <i class="bi bi-whatsapp"></i>
                    <h6>WhatsApp Messages</h6>
                    <p id="whatsappCount">0</p>
                </div>
                <div class="comm-stat email">
                    <i class="bi bi-envelope"></i>
                    <h6>Email Sent</h6>
                    <p id="emailCount">0</p>
                </div>
            </div>
        </div>
        
        <!-- Charts Section -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-graph-up"></i> Data Analytics</h5>
            </div>
            <div class="card-body">
                <div class="chart-tabs">
                    <div class="chart-tab active" onclick="showChart('status')">Status Distribution</div>
                    <div class="chart-tab" onclick="showChart('platform')">Platform Comparison</div>
                    <div class="chart-tab" onclick="showChart('trend')">Ticket Trend</div>
                </div>
                <div class="chart-container">
                    <canvas id="analyticsChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- Platform Statistics -->
        <div class="platform-stats">
            <div class="platform-card noon">
                <i class="bi bi-cart-check platform-icon"></i>
                <h3 id="noonCount">0</h3>
                <p>Noon Orders</p>
                <div class="percentage" id="noonPercentage">0%</div>
            </div>
            <div class="platform-card careem">
                <i class="bi bi-car-front platform-icon"></i>
                <h3 id="careemCount">0</h3>
                <p>Careem Orders</p>
                <div class="percentage" id="careemPercentage">0%</div>
            </div>
        </div>
        
        <!-- Recent Tickets -->
        <div class="recent-tickets">
            <h5><i class="bi bi-clock-history"></i> Recent Tickets</h5>
            <div id="recentTicketsList">
                <div class="empty-state">
                    <i class="bi bi-inbox"></i>
                    <h5>No recent tickets</h5>
                    <p>Add your first complaint ticket using the button below</p>
                </div>
            </div>
        </div>
        
        <!-- Stats Cards -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stats-card total">
                    <h3 id="totalTickets">0</h3>
                    <p>Total Tickets</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card open">
                    <h3 id="openTickets">0</h3>
                    <p>Open Tickets</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card sent">
                    <h3 id="sentTickets">0</h3>
                    <p>Sent Tickets</p>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stats-card closed">
                    <h3 id="closedTickets">0</h3>
                    <p>Closed Tickets</p>
                </div>
            </div>
        </div>
        
        <!-- Help Section -->
        <div class="help-section">
            <h5><i class="bi bi-question-circle"></i> How to Use This Dashboard</h5>
            <div class="help-item">
                <i class="bi bi-plus-circle"></i>
                <div>
                    <h6>Add New Ticket</h6>
                    <p>Click the "Add New Ticket" button to create a new complaint record</p>
                </div>
            </div>
            <div class="help-item">
                <i class="bi bi-funnel"></i>
                <div>
                    <h6>Filter Tickets</h6>
                    <p>Use the filter section to find specific tickets by order ID, branch, platform, or date</p>
                </div>
            </div>
            <div class="help-item">
                <i class="bi bi-pencil"></i>
                <div>
                    <h6>Edit Tickets</h6>
                    <p>Click the edit button to modify ticket details and evidence</p>
                </div>
            </div>
            <div class="help-item">
                <i class="bi bi-whatsapp"></i>
                <div>
                    <h6>Communicate via WhatsApp</h6>
                    <p>Send messages directly to customers using WhatsApp integration with status indicators</p>
                </div>
            </div>
        </div>
        
        <!-- Filters -->
        <div class="filter-section">
            <h5><i class="bi bi-funnel"></i> Filters</h5>
            <div class="row">
                <div class="col-md-3 mb-3">
                    <label for="searchOrder" class="form-label">Search Order ID</label>
                    <input type="text" class="form-control" id="searchOrder" placeholder="Enter Order ID">
                </div>
                <div class="col-md-3 mb-3">
                    <label for="filterBranch" class="form-label">Filter by Branch</label>
                    <select class="form-select" id="filterBranch">
                        <option value="">All Branches</option>
                        <option value="Crispy Chicken Khalidiya">Crispy Chicken Khalidiya</option>
                        <option value="Crispy Chicken Muroor">Crispy Chicken Muroor</option>
                        <option value="Crispy Chicken Shabiya 11">Crispy Chicken Shabiya 11</option>
                        <option value="Crispy Chicken Al Barsha">Crispy Chicken Al Barsha</option>
                        <option value="Crispy Chicken Al Satwa">Crispy Chicken Al Satwa</option>
                        <option value="Crispy Chicken Electra">Crispy Chicken Electra</option>
                        <option value="Crispy Chicken Hamdan">Crispy Chicken Hamdan</option>
                    </select>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="filterPlatform" class="form-label">Filter by Platform</label>
                    <select class="form-select" id="filterPlatform">
                        <option value="">All Platforms</option>
                        <option value="Noon">Noon</option>
                        <option value="Careem">Careem</option>
                    </select>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="filterStatus" class="form-label">Filter by Status</label>
                    <select class="form-select" id="filterStatus">
                        <option value="">All Statuses</option>
                        <option value="Open">Open</option>
                        <option value="Sent">Sent</option>
                        <option value="Closed">Closed</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="filterDateFrom" class="form-label">Date From</label>
                    <input type="date" class="form-control" id="filterDateFrom">
                </div>
                <div class="col-md-4 mb-3">
                    <label for="filterDateTo" class="form-label">Date To</label>
                    <input type="date" class="form-control" id="filterDateTo">
                </div>
                <div class="col-md-4 mb-3">
                    <label for="filterOrderDate" class="form-label">Order Date</label>
                    <input type="date" class="form-control" id="filterOrderDate">
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <button class="btn btn-crispy" onclick="applyFilters()">
                        <i class="bi bi-funnel"></i> Apply Filters
                    </button>
                    <button class="btn btn-outline-secondary" onclick="resetFilters()">
                        <i class="bi bi-x-circle"></i> Reset Filters
                    </button>
                    <button class="btn btn-outline-primary" onclick="exportToCSV()">
                        <i class="bi bi-download"></i> Export to CSV
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Add New Ticket Button -->
        <div class="text-center mb-5">
            <button class="btn btn-crispy btn-lg pulse" onclick="openForm()">
                <i class="bi bi-plus-circle"></i> Add New Ticket
            </button>
        </div>
        
        <!-- Add Sample Ticket Button -->
        <div class="text-center mb-3">
            <button class="btn btn-outline-info" onclick="addSampleTicket()">
                <i class="bi bi-plus-circle"></i> Add Sample Ticket
            </button>
        </div>
        
        <!-- Generate Random Tickets Button -->
        <div class="text-center mb-5">
            <button class="btn btn-outline-warning" onclick="generateRandomTickets()">
                <i class="bi bi-shuffle"></i> Generate Random Tickets
            </button>
        </div>
        
        <!-- Tickets Table -->
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-list-task"></i> Complaint Tickets</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover" id="ticketsTable">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Order Date</th>
                                <th>Branch</th>
                                <th>Platform</th>
                                <th>Issue</th>
                                <th>Evidence</th>
                                <th>Status</th>
                                <th>Compensation</th>
                                <th>Date Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div id="emptyState" class="empty-state" style="display: none;">
                    <i class="bi bi-inbox"></i>
                    <h5>No tickets found</h5>
                    <p>Add your first complaint ticket using the button above</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Form Overlay -->
    <div class="form-overlay" id="formOverlay" onclick="closeForm()"></div>
    
    <!-- Add Ticket Form -->
    <div class="form-popup" id="orderForm">
        <h3><i class="bi bi-plus-circle"></i> Add New Ticket</h3>
        <label>Order ID</label>
        <input type="text" id="orderId" required>
        
        <label>Order Date</label>
        <input type="date" id="orderDate" required>
        
        <label>Branch</label>
        <select id="branch" required>
            <option value="">Select Branch</option>
            <option value="Crispy Chicken Khalidiya">Crispy Chicken Khalidiya</option>
            <option value="Crispy Chicken Muroor">Crispy Chicken Muroor</option>
            <option value="Crispy Chicken Shabiya 11">Crispy Chicken Shabiya 11</option>
            <option value="Crispy Chicken Al Barsha">Crispy Chicken Al Barsha</option>
            <option value="Crispy Chicken Al Satwa">Crispy Chicken Al Satwa</option>
            <option value="Crispy Chicken Electra">Crispy Chicken Electra</option>
            <option value="Crispy Chicken Hamdan">Crispy Chicken Hamdan</option>
        </select>
        
        <label>Platform</label>
        <select id="platform" required>
            <option value="">Select Platform</option>
            <option value="Noon">Noon</option>
            <option value="Careem">Careem</option>
        </select>
        
        <label>Issue Description</label>
        <textarea id="issue" required></textarea>
        
        <label>Compensation Value (AED)</label>
        <input type="number" id="compensation" placeholder="Enter compensation amount" min="0" step="0.01" required>
        
        <div class="evidence-section">
            <h5><i class="bi bi-paperclip"></i> Evidence Upload</h5>
            <p class="text-muted mb-3">Upload photos, videos, or other evidence files to support your claim</p>
            
            <div class="file-drop-area" id="fileDropArea">
                <i class="bi bi-cloud-upload fs-1 text-muted"></i>
                <p class="mb-2">Drag & drop files here or click to browse</p>
                <small class="text-muted">Supported formats: JPG, PNG, PDF, MP4 (Max 10MB)</small>
                <input type="file" class="file-input" id="fileInput" multiple accept=".jpg,.jpeg,.png,.pdf,.mp4">
            </div>
            
            <div class="file-list" id="fileList"></div>
            
            <div class="mt-3">
                <label class="form-label">Or provide a link to evidence:</label>
                <input type="url" class="form-control" id="evidenceLink" placeholder="https://example.com/evidence.jpg">
                <div class="form-check mt-2">
                    <input class="form-check-input" type="checkbox" id="noEvidence">
                    <label class="form-check-label" for="noEvidence">
                        No evidence available
                    </label>
                </div>
            </div>
        </div>
        
        <div class="d-flex gap-3 mt-4">
            <button class="btn btn-crispy" onclick="saveTicket()">
                <i class="bi bi-check-circle"></i> Save Ticket
            </button>
            <button class="btn btn-outline-secondary" onclick="closeForm()">
                <i class="bi bi-x-circle"></i> Cancel
            </button>
        </div>
    </div>
    
    <!-- Sample Ticket Form -->
    <div class="form-popup" id="sampleTicketForm">
        <h3><i class="bi bi-plus-circle"></i> Add Sample Ticket</h3>
        <div class="mb-3">
            <label class="form-label">Order ID</label>
            <input type="text" class="form-control" id="sampleOrderId" placeholder="e.g., NC123456">
        </div>
        <div class="mb-3">
            <label class="form-label">Branch</label>
            <select class="form-select" id="sampleBranch">
                <option value="Crispy Chicken Khalidiya">Crispy Chicken Khalidiya</option>
                <option value="Crispy Chicken Muroor">Crispy Chicken Muroor</option>
                <option value="Crispy Chicken Shabiya 11">Crispy Chicken Shabiya 11</option>
                <option value="Crispy Chicken Al Barsha">Crispy Chicken Al Barsha</option>
                <option value="Crispy Chicken Al Satwa">Crispy Chicken Al Satwa</option>
                <option value="Crispy Chicken Electra">Crispy Chicken Electra</option>
                <option value="Crispy Chicken Hamdan">Crispy Chicken Hamdan</option>
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label">Platform</label>
            <select class="form-select" id="samplePlatform">
                <option value="Noon">Noon</option>
                <option value="Careem">Careem</option>
            </select>
        </div>
        <div class="mb-3">
            <label class="form-label">Issue</label>
            <textarea class="form-control" id="sampleIssue" rows="3" placeholder="Describe the issue..."></textarea>
        </div>
        <div class="mb-3">
            <label class="form-label">Compensation (AED)</label>
            <input type="number" class="form-control" id="sampleCompensation" min="0" step="0.01" placeholder="0.00">
        </div>
        <div class="mb-3">
            <label class="form-label">Evidence Link</label>
            <input type="url" class="form-control" id="sampleEvidence" placeholder="https://example.com/evidence.jpg">
        </div>
        <div class="d-flex gap-3">
            <button class="btn btn-crispy" onclick="saveSampleTicket()">
                <i class="bi bi-check-circle"></i> Add Ticket
            </button>
            <button class="btn btn-outline-secondary" onclick="closeSampleTicketForm()">
                <i class="bi bi-x-circle"></i> Cancel
            </button>
        </div>
    </div>
    
    <!-- Edit Ticket Form -->
    <div class="form-popup" id="editTicketForm">
        <h3><i class="bi bi-pencil"></i> Edit Ticket</h3>
        <input type="hidden" id="editTicketId">
        
        <label>Order ID</label>
        <input type="text" id="editOrderId" required>
        
        <label>Order Date</label>
        <input type="date" id="editOrderDate" required>
        
        <label>Branch</label>
        <select id="editBranch" required>
            <option value="">Select Branch</option>
            <option value="Crispy Chicken Khalidiya">Crispy Chicken Khalidiya</option>
            <option value="Crispy Chicken Muroor">Crispy Chicken Muroor</option>
            <option value="Crispy Chicken Shabiya 11">Crispy Chicken Shabiya 11</option>
            <option value="Crispy Chicken Al Barsha">Crispy Chicken Al Barsha</option>
            <option value="Crispy Chicken Al Satwa">Crispy Chicken Al Satwa</option>
            <option value="Crispy Chicken Electra">Crispy Chicken Electra</option>
            <option value="Crispy Chicken Hamdan">Crispy Chicken Hamdan</option>
        </select>
        
        <label>Platform</label>
        <select id="editPlatform" required>
            <option value="">Select Platform</option>
            <option value="Noon">Noon</option>
            <option value="Careem">Careem</option>
        </select>
        
        <label>Issue Description</label>
        <textarea id="editIssue" required></textarea>
        
        <label>Compensation Value (AED)</label>
        <input type="number" id="editCompensation" placeholder="Enter compensation amount" min="0" step="0.01" required>
        
        <div class="evidence-section">
            <h5><i class="bi bi-paperclip"></i> Evidence</h5>
            <label class="form-label">Evidence (link or description):</label>
            <input type="text" class="form-control" id="editEvidence">
            <div class="form-check mt-2">
                <input class="form-check-input" type="checkbox" id="editNoEvidence">
                <label class="form-check-label" for="editNoEvidence">
                    No evidence available
                </label>
            </div>
        </div>
        
        <div class="d-flex gap-3 mt-4">
            <button class="btn btn-crispy" onclick="saveEditedTicket()">
                <i class="bi bi-check-circle"></i> Save Changes
            </button>
            <button class="btn btn-outline-secondary" onclick="closeEditForm()">
                <i class="bi bi-x-circle"></i> Cancel
            </button>
        </div>
    </div>
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2023 Crispy Chicken Delivery Management System. All rights reserved.</p>
        </div>
    </footer>
    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="bi bi-check-circle-fill"></i>
        <span id="notificationText">Action completed successfully!</span>
    </div>
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Global variables
        let tickets = JSON.parse(localStorage.getItem('crispyTickets')) || [];
        let filteredTickets = [...tickets];
        let uploadedFiles = [];
        let analyticsChart = null;
        let currentChartType = 'status';
        let whatsappCount = 0;
        let emailCount = 0;
        
        // WhatsApp branch numbers with status
        const branchNumbers = {
            "Crispy Chicken Khalidiya": { number: "971569494764", status: "online" },
            "Crispy Chicken Muroor": { number: "971505414641", status: "online" },
            "Crispy Chicken Shabiya 11": { number: "971562690688", status: "offline" },
            "Crispy Chicken Al Barsha": { number: "971569659524", status: "online" },
            "Crispy Chicken Al Satwa": { number: "971567970685", status: "offline" },
            "Crispy Chicken Electra": { number: "971563866859", status: "online" },
            "Crispy Chicken Hamdan": { number: "971556886650", status: "online" }
        };
        
        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing...');
            
            // Set today's date as default for order date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('orderDate').value = today;
            
            // Initialize file upload
            initFileUpload();
            
            // Initialize chart
            initChart();
            
            // Render initial data
            renderTickets();
            updateStats();
            updatePlatformStats();
            updateRecentTickets();
            updateQuickStats();
            updateCommunicationStats();
            
            // Add event listeners
            document.getElementById('searchOrder').addEventListener('input', applyFilters);
            document.getElementById('filterBranch').addEventListener('change', applyFilters);
            document.getElementById('filterPlatform').addEventListener('change', applyFilters);
            document.getElementById('filterStatus').addEventListener('change', applyFilters);
            document.getElementById('filterDateFrom').addEventListener('change', applyFilters);
            document.getElementById('filterDateTo').addEventListener('change', applyFilters);
            document.getElementById('filterOrderDate').addEventListener('change', applyFilters);
            
            // Show notification on load
            showNotification('Dashboard loaded successfully!', 'success');
            
            // Simulate WhatsApp status changes
            setInterval(updateWhatsAppStatus, 5000);
        });
        
        // Initialize chart
        function initChart() {
            const ctx = document.getElementById('analyticsChart').getContext('2d');
            analyticsChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Open', 'Sent', 'Closed'],
                    datasets: [{
                        data: [0, 0, 0],
                        backgroundColor: [
                            '#0d47a1',
                            '#ff8f00',
                            '#2e7d32'
                        ],
                        borderColor: [
                            '#0d47a1',
                            '#ff8f00',
                            '#2e7d32'
                        ],
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                },
                                padding: 20
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 16
                            },
                            bodyFont: {
                                size: 14
                            },
                            padding: 15,
                            cornerRadius: 10
                        }
                    },
                    animation: {
                        animateRotate: true,
                        animateScale: true
                    }
                }
            });
            
            // Update chart data
            updateChart();
        }
        
        // Update chart based on current type
        function updateChart() {
            if (!analyticsChart) return;
            
            let data, labels;
            
            if (currentChartType === 'status') {
                const open = tickets.filter(t => t.status === 'Open').length;
                const sent = tickets.filter(t => t.status === 'Sent').length;
                const closed = tickets.filter(t => t.status === 'Closed').length;
                
                data = [open, sent, closed];
                labels = ['Open', 'Sent', 'Closed'];
            } else if (currentChartType === 'platform') {
                const noon = tickets.filter(t => t.platform === 'Noon').length;
                const careem = tickets.filter(t => t.platform === 'Careem').length;
                
                data = [noon, careem];
                labels = ['Noon', 'Careem'];
            } else if (currentChartType === 'trend') {
                // Generate trend data for last 7 days
                const today = new Date();
                const labels = [];
                const data = [];
                
                for (let i = 6; i >= 0; i--) {
                    const date = new Date(today);
                    date.setDate(date.getDate() - i);
                    const dateStr = date.toISOString().split('T')[0];
                    
                    labels.push(date.toLocaleDateString('en-US', { weekday: 'short' }));
                    data.push(tickets.filter(t => t.dateCreated === dateStr).length);
                }
                
                analyticsChart.config.type = 'line';
                analyticsChart.data.labels = labels;
                analyticsChart.data.datasets[0].data = data;
                analyticsChart.data.datasets[0].backgroundColor = 'rgba(211, 47, 47, 0.2)';
                analyticsChart.data.datasets[0].borderColor = '#d32f2f';
                analyticsChart.data.datasets[0].tension = 0.4;
                analyticsChart.data.datasets[0].fill = true;
            }
            
            analyticsChart.data.datasets[0].data = data;
            analyticsChart.update();
        }
        
        // Show specific chart
        function showChart(type) {
            currentChartType = type;
            
            // Update tab styles
            document.querySelectorAll('.chart-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update chart
            updateChart();
        }
        
        // Update WhatsApp status
        function updateWhatsAppStatus() {
            // Randomly change some statuses for demo
            Object.keys(branchNumbers).forEach(branch => {
                if (Math.random() > 0.7) {
                    branchNumbers[branch].status = branchNumbers[branch].status === 'online' ? 'offline' : 'online';
                }
            });
            
            // Update UI
            renderTickets();
        }
        
        // Update communication statistics
        function updateCommunicationStats() {
            document.getElementById('whatsappCount').textContent = whatsappCount;
            document.getElementById('emailCount').textContent = emailCount;
        }
        
        // Initialize file upload functionality
        function initFileUpload() {
            const fileDropArea = document.getElementById('fileDropArea');
            const fileInput = document.getElementById('fileInput');
            
            // Click to browse files
            fileDropArea.addEventListener('click', () => {
                fileInput.click();
            });
            
            // File input change event
            fileInput.addEventListener('change', handleFiles);
            
            // Drag and drop events
            fileDropArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileDropArea.classList.add('drag-over');
            });
            
            fileDropArea.addEventListener('dragleave', () => {
                fileDropArea.classList.remove('drag-over');
            });
            
            fileDropArea.addEventListener('drop', (e) => {
                e.preventDefault();
                fileDropArea.classList.remove('drag-over');
                handleFiles({ target: { files: e.dataTransfer.files } });
            });
        }
        
        // Handle file uploads
        function handleFiles(e) {
            const files = e.target.files;
            const fileList = document.getElementById('fileList');
            
            // Validate file types and sizes
            const validTypes = ['image/jpeg', 'image/png', 'application/pdf', 'video/mp4'];
            const maxSize = 10 * 1024 * 1024; // 10MB
            
            for (let file of files) {
                if (!validTypes.includes(file.type)) {
                    showNotification(`Invalid file type: ${file.name}`, 'error');
                    continue;
                }
                
                if (file.size > maxSize) {
                    showNotification(`File too large: ${file.name}`, 'error');
                    continue;
                }
                
                // Add file to list
                uploadedFiles.push(file);
                displayFile(file);
            }
        }
        
        // Display uploaded files
        function displayFile(file) {
            const fileList = document.getElementById('fileList');
            const fileItem = document.createElement('div');
            fileItem.className = 'file-item';
            
            const fileIcon = getFileIcon(file.type);
            const fileSize = formatFileSize(file.size);
            
            fileItem.innerHTML = `
                <div>
                    <i class="${fileIcon}"></i>
                    <span>${file.name} (${fileSize})</span>
                </div>
                <button onclick="removeFile('${file.name}')">
                    <i class="bi bi-trash"></i>
                </button>
            `;
            
            fileList.appendChild(fileItem);
        }
        
        // Get file icon based on type
        function getFileIcon(fileType) {
            if (fileType.startsWith('image/')) return 'bi bi-image';
            if (fileType === 'application/pdf') return 'bi bi-file-pdf';
            if (fileType.startsWith('video/')) return 'bi bi-file-play';
            return 'bi bi-file-earmark';
        }
        
        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // Remove file from list
        function removeFile(fileName) {
            uploadedFiles = uploadedFiles.filter(file => file.name !== fileName);
            updateFileList();
        }
        
        // Update file list display
        function updateFileList() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';
            
            uploadedFiles.forEach(file => {
                displayFile(file);
            });
        }
        
        // Reset form
        function resetForm() {
            document.getElementById('orderForm').querySelector('input, select, textarea').forEach(el => {
                el.value = '';
            });
            document.getElementById('noEvidence').checked = false;
            document.getElementById('evidenceLink').value = '';
            uploadedFiles = [];
            updateFileList();
        }
        
        // Open form
        function openForm() {
            const form = document.getElementById('orderForm');
            const overlay = document.getElementById('formOverlay');
            
            resetForm();
            form.classList.add('show');
            overlay.classList.add('show');
        }
        
        // Close form
        function closeForm() {
            const form = document.getElementById('orderForm');
            const overlay = document.getElementById('formOverlay');
            
            form.classList.remove('show');
            overlay.classList.remove('show');
        }
        
        // Save ticket
        function saveTicket() {
            // Validate form
            const orderId = document.getElementById('orderId').value.trim();
            const orderDate = document.getElementById('orderDate').value;
            const branch = document.getElementById('branch').value;
            const platform = document.getElementById('platform').value;
            const issue = document.getElementById('issue').value.trim();
            const compensation = document.getElementById('compensation').value;
            const noEvidence = document.getElementById('noEvidence').checked;
            const evidenceLink = document.getElementById('evidenceLink').value.trim();
            
            if (!orderId || !orderDate || !branch || !platform || !issue || !compensation) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            // Create new ticket
            const newTicket = {
                id: Date.now(),
                orderId,
                orderDate,
                branch,
                platform,
                issue,
                compensation: parseFloat(compensation),
                evidence: noEvidence ? 'None' : evidenceLink,
                status: 'Open',
                dateCreated: new Date().toISOString().split('T')[0],
                files: uploadedFiles.map(file => file.name)
            };
            
            // Add to tickets array
            tickets.unshift(newTicket);
            filteredTickets = [...tickets];
            
            // Save to localStorage
            localStorage.setItem('crispyTickets', JSON.stringify(tickets));
            
            // Update UI
            renderTickets();
            updateStats();
            updatePlatformStats();
            updateRecentTickets();
            updateQuickStats();
            updateChart();
            
            // Close form and show notification
            closeForm();
            showNotification('Ticket added successfully!', 'success');
        }
        
        // Open edit form
        function openEditForm(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const form = document.getElementById('editTicketForm');
            const overlay = document.getElementById('formOverlay');
            
            // Populate form with ticket data
            document.getElementById('editTicketId').value = ticket.id;
            document.getElementById('editOrderId').value = ticket.orderId;
            document.getElementById('editOrderDate').value = ticket.orderDate;
            document.getElementById('editBranch').value = ticket.branch;
            document.getElementById('editPlatform').value = ticket.platform;
            document.getElementById('editIssue').value = ticket.issue;
            document.getElementById('editCompensation').value = ticket.compensation;
            document.getElementById('editEvidence').value = ticket.evidence;
            document.getElementById('editNoEvidence').checked = ticket.evidence === 'None';
            
            form.classList.add('show');
            overlay.classList.add('show');
        }
        
        // Close edit form
        function closeEditForm() {
            const form = document.getElementById('editTicketForm');
            const overlay = document.getElementById('formOverlay');
            
            form.classList.remove('show');
            overlay.classList.remove('show');
        }
        
        // Save edited ticket
        function saveEditedTicket() {
            const ticketId = parseInt(document.getElementById('editTicketId').value);
            const ticketIndex = tickets.findIndex(t => t.id === ticketId);
            
            if (ticketIndex === -1) return;
            
            // Get form values
            const updatedTicket = {
                ...tickets[ticketIndex],
                orderId: document.getElementById('editOrderId').value.trim(),
                orderDate: document.getElementById('editOrderDate').value,
                branch: document.getElementById('editBranch').value,
                platform: document.getElementById('editPlatform').value,
                issue: document.getElementById('editIssue').value.trim(),
                compensation: parseFloat(document.getElementById('editCompensation').value),
                evidence: document.getElementById('editNoEvidence').checked ? 'None' : document.getElementById('editEvidence').value.trim()
            };
            
            // Update ticket
            tickets[ticketIndex] = updatedTicket;
            filteredTickets = [...tickets];
            
            // Save to localStorage
            localStorage.setItem('crispyTickets', JSON.stringify(tickets));
            
            // Update UI
            renderTickets();
            updateStats();
            updatePlatformStats();
            updateRecentTickets();
            updateQuickStats();
            updateChart();
            
            // Close form and show notification
            closeEditForm();
            showNotification('Ticket updated successfully!', 'success');
        }
        
        // Close ticket
        function closeTicket(ticketId) {
            if (!confirm('Are you sure you want to close this ticket?')) return;
            
            const ticketIndex = tickets.findIndex(t => t.id === ticketId);
            if (ticketIndex === -1) return;
            
            tickets[ticketIndex].status = 'Closed';
            filteredTickets = [...tickets];
            
            localStorage.setItem('crispyTickets', JSON.stringify(tickets));
            
            renderTickets();
            updateStats();
            updatePlatformStats();
            updateRecentTickets();
            updateQuickStats();
            updateChart();
            
            showNotification('Ticket closed successfully!', 'success');
        }
        
        // Send email
        function sendEmail(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const subject = `Complaint Regarding Order ${ticket.orderId}`;
            const body = `Dear Customer,\n\nWe are writing regarding your complaint about order ${ticket.orderId} from ${ticket.branch}.\n\nIssue: ${ticket.issue}\n\nWe are investigating this matter and will get back to you shortly.\n\nThank you,\nCrispy Chicken Team`;
            
            const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.location.href = mailtoLink;
            
            // Update ticket status and communication count
            const ticketIndex = tickets.findIndex(t => t.id === ticketId);
            if (ticketIndex !== -1) {
                tickets[ticketIndex].status = 'Sent';
                filteredTickets = [...tickets];
                
                emailCount++;
                updateCommunicationStats();
                
                localStorage.setItem('crispyTickets', JSON.stringify(tickets));
                
                renderTickets();
                updateStats();
                updatePlatformStats();
                updateRecentTickets();
                updateQuickStats();
                updateChart();
            }
            
            showNotification('Email client opened!', 'success');
        }
        
        // Send WhatsApp
        function sendWhatsApp(ticketId) {
            const ticket = tickets.find(t => t.id === ticketId);
            if (!ticket) return;
            
            const branchNumber = branchNumbers[ticket.branch];
            if (!branchNumber) {
                showNotification('WhatsApp number not available for this branch', 'error');
                return;
            }
            
            const message = `Hi, I'm writing about my order ${ticket.orderId} from ${ticket.branch}. The issue was: ${ticket.issue}. Please assist.`;
            const whatsappUrl = `https://wa.me/${branchNumber.number}?text=${encodeURIComponent(message)}`;
            
            // Open WhatsApp in new tab
            window.open(whatsappUrl, '_blank');
            
            // Update ticket status and communication count
            const ticketIndex = tickets.findIndex(t => t.id === ticketId);
            if (ticketIndex !== -1) {
                tickets[ticketIndex].status = 'Sent';
                filteredTickets = [...tickets];
                
                whatsappCount++;
                updateCommunicationStats();
                
                localStorage.setItem('crispyTickets', JSON.stringify(tickets));
                
                renderTickets();
                updateStats();
                updatePlatformStats();
                updateRecentTickets();
                updateQuickStats();
                updateChart();
            }
            
            showNotification('WhatsApp opened!', 'success');
        }
        
        // Apply filters
        function applyFilters() {
            const searchTerm = document.getElementById('searchOrder').value.toLowerCase();
            const branchFilter = document.getElementById('filterBranch').value;
            const platformFilter = document.getElementById('filterPlatform').value;
            const statusFilter = document.getElementById('filterStatus').value;
            const dateFrom = document.getElementById('filterDateFrom').value;
            const dateTo = document.getElementById('filterDateTo').value;
            const orderDate = document.getElementById('filterOrderDate').value;
            
            filteredTickets = tickets.filter(ticket => {
                // Search filter
                if (searchTerm && !ticket.orderId.toLowerCase().includes(searchTerm)) {
                    return false;
                }
                
                // Branch filter
                if (branchFilter && ticket.branch !== branchFilter) {
                    return false;
                }
                
                // Platform filter
                if (platformFilter && ticket.platform !== platformFilter) {
                    return false;
                }
                
                // Status filter
                if (statusFilter && ticket.status !== statusFilter) {
                    return false;
                }
                
                // Date range filters
                if (dateFrom && ticket.dateCreated < dateFrom) {
                    return false;
                }
                
                if (dateTo && ticket.dateCreated > dateTo) {
                    return false;
                }
                
                // Order date filter
                if (orderDate && ticket.orderDate !== orderDate) {
                    return false;
                }
                
                return true;
            });
            
            renderTickets();
            showNotification(`Found ${filteredTickets.length} matching tickets`, 'info');
        }
        
        // Reset filters
        function resetFilters() {
            document.getElementById('searchOrder').value = '';
            document.getElementById('filterBranch').value = '';
            document.getElementById('filterPlatform').value = '';
            document.getElementById('filterStatus').value = '';
            document.getElementById('filterDateFrom').value = '';
            document.getElementById('filterDateTo').value = '';
            document.getElementById('filterOrderDate').value = '';
            
            filteredTickets = [...tickets];
            renderTickets();
            showNotification('Filters reset', 'info');
        }
        
        // Export to CSV
        function exportToCSV() {
            if (filteredTickets.length === 0) {
                showNotification('No tickets to export', 'error');
                return;
            }
            
            // Define CSV headers
            const headers = [
                'Order ID',
                'Order Date',
                'Branch',
                'Platform',
                'Issue',
                'Evidence',
                'Status',
                'Compensation (AED)',
                'Date Created'
            ];
            
            // Create CSV content
            const csvContent = [
                headers.join(','),
                ...filteredTickets.map(ticket => [
                    ticket.orderId,
                    ticket.orderDate,
                    ticket.branch,
                    ticket.platform,
                    `"${ticket.issue.replace(/"/g, '""')}"`,
                    ticket.evidence,
                    ticket.status,
                    ticket.compensation,
                    ticket.dateCreated
                ].join(','))
            ].join('\n');
            
            // Create blob and download
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `crispy_tickets_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('CSV exported successfully!', 'success');
        }
        
        // Render tickets table
        function renderTickets() {
            const tbody = document.querySelector('#ticketsTable tbody');
            const emptyState = document.getElementById('emptyState');
            
            // Clear existing rows
            tbody.innerHTML = '';
            
            if (filteredTickets.length === 0) {
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // Add tickets to table
            filteredTickets.forEach(ticket => {
                const row = document.createElement('tr');
                row.className = 'new-ticket-row';
                
                const statusClass = `badge-${ticket.status.toLowerCase()}`;
                const evidenceText = ticket.evidence === 'None' ? 
                    '<span class="evidence-none">No evidence</span>' : 
                    `<a href="${ticket.evidence}" class="evidence-link" target="_blank">${ticket.evidence}</a>`;
                
                // Get WhatsApp status for this branch
                const branchInfo = branchNumbers[ticket.branch];
                const whatsappStatus = branchInfo ? branchInfo.status : 'offline';
                
                row.innerHTML = `
                    <td>${ticket.orderId}</td>
                    <td>${ticket.orderDate}</td>
                    <td>${ticket.branch}</td>
                    <td>${ticket.platform}</td>
                    <td>${ticket.issue}</td>
                    <td>${evidenceText}</td>
                    <td><span class="badge ${statusClass}">${ticket.status}</span></td>
                    <td>AED ${ticket.compensation.toFixed(2)}</td>
                    <td>${ticket.dateCreated}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn btn-edit" onclick="openEditForm(${ticket.id})">
                                <i class="bi bi-pencil"></i> Edit
                            </button>
                            <button class="btn btn-email" onclick="sendEmail(${ticket.id})">
                                <i class="bi bi-envelope"></i> Email
                            </button>
                            <button class="btn btn-whatsapp" onclick="sendWhatsApp(${ticket.id})">
                                <i class="bi bi-whatsapp"></i> WhatsApp
                                <span class="status ${whatsappStatus}"></span>
                            </button>
                            <button class="btn btn-close-ticket" onclick="closeTicket(${ticket.id})">
                                <i class="bi bi-check-circle"></i> Close
                            </button>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // Update statistics
        function updateStats() {
            const total = tickets.length;
            const open = tickets.filter(t => t.status === 'Open').length;
            const sent = tickets.filter(t => t.status === 'Sent').length;
            const closed = tickets.filter(t => t.status === 'Closed').length;
            
            document.getElementById('totalTickets').textContent = total;
            document.getElementById('openTickets').textContent = open;
            document.getElementById('sentTickets').textContent = sent;
            document.getElementById('closedTickets').textContent = closed;
        }
        
        // Update platform statistics
        function updatePlatformStats() {
            const noonTickets = tickets.filter(t => t.platform === 'Noon');
            const careemTickets = tickets.filter(t => t.platform === 'Careem');
            
            const total = tickets.length;
            const noonCount = noonTickets.length;
            const careemCount = careemTickets.length;
            
            document.getElementById('noonCount').textContent = noonCount;
            document.getElementById('careemCount').textContent = careemCount;
            
            // Calculate percentages
            const noonPercentage = total > 0 ? ((noonCount / total) * 100).toFixed(1) : 0;
            const careemPercentage = total > 0 ? ((careemCount / total) * 100).toFixed(1) : 0;
            
            document.getElementById('noonPercentage').textContent = `${noonPercentage}%`;
            document.getElementById('careemPercentage').textContent = `${careemPercentage}%`;
        }
        
        // Update recent tickets
        function updateRecentTickets() {
            const recentTicketsList = document.getElementById('recentTicketsList');
            const recentTickets = tickets.slice(0, 5); // Get last 5 tickets
            
            if (recentTickets.length === 0) {
                recentTicketsList.innerHTML = `
                    <div class="empty-state">
                        <i class="bi bi-inbox"></i>
                        <h5>No recent tickets</h5>
                        <p>Add your first complaint ticket using the button below</p>
                    </div>
                `;
                return;
            }
            
            recentTicketsList.innerHTML = '';
            
            recentTickets.forEach(ticket => {
                const ticketItem = document.createElement('div');
                ticketItem.className = 'recent-ticket-item';
                
                const statusClass = `recent-ticket-status-${ticket.status.toLowerCase()}`;
                
                ticketItem.innerHTML = `
                    <div class="recent-ticket-info">
                        <h6>Order ${ticket.orderId}</h6>
                        <p>${ticket.branch}  ${ticket.platform}</p>
                    </div>
                    <span class="recent-ticket-status ${statusClass}">${ticket.status}</span>
                `;
                
                recentTicketsList.appendChild(ticketItem);
            });
        }
        
        // Update quick stats
        function updateQuickStats() {
            const total = tickets.length;
            const open = tickets.filter(t => t.status === 'Open').length;
            const sent = tickets.filter(t => t.status === 'Sent').length;
            const closed = tickets.filter(t => t.status === 'Closed').length;
            
            document.getElementById('quickTotal').textContent = total;
            document.getElementById('quickOpen').textContent = open;
            document.getElementById('quickSent').textContent = sent;
            document.getElementById('quickClosed').textContent = closed;
        }
        
        // Add sample ticket
        function addSampleTicket() {
            const sampleTicketForm = document.getElementById('sampleTicketForm');
            sampleTicketForm.classList.add('show');
            
            // Set default values
            const today = new Date().toISOString().split('T')[0];
            const orderId = `NC${Math.floor(Math.random() * 900000) + 100000}`;
            
            document.getElementById('sampleOrderId').value = orderId;
            document.getElementById('sampleBranch').value = 'Crispy Chicken Khalidiya';
            document.getElementById('samplePlatform').value = 'Noon';
            document.getElementById('sampleIssue').value = 'Food was cold and delivery was late';
            document.getElementById('sampleCompensation').value = '50.00';
            document.getElementById('sampleEvidence').value = 'https://example.com/evidence.jpg';
        }
        
        // Close sample ticket form
        function closeSampleTicketForm() {
            document.getElementById('sampleTicketForm').classList.remove('show');
        }
        
        // Save sample ticket
        function saveSampleTicket() {
            const orderId = document.getElementById('sampleOrderId').value.trim();
            const branch = document.getElementById('sampleBranch').value;
            const platform = document.getElementById('samplePlatform').value;
            const issue = document.getElementById('sampleIssue').value.trim();
            const compensation = parseFloat(document.getElementById('sampleCompensation').value) || 0;
            const evidence = document.getElementById('sampleEvidence').value.trim();
            
            if (!orderId || !branch || !platform || !issue) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            // Create new ticket
            const newTicket = {
                id: Date.now(),
                orderId,
                orderDate: new Date().toISOString().split('T')[0],
                branch,
                platform,
                issue,
                compensation: compensation,
                evidence: evidence || 'None',
                status: 'Open',
                dateCreated: new Date().toISOString().split('T')[0],
                files: []
            };
            
            // Add to tickets array
            tickets.unshift(newTicket);
            filteredTickets = [...tickets];
            
            // Save to localStorage
            localStorage.setItem('crispyTickets', JSON.stringify(tickets));
            
            // Update UI
            renderTickets();
            updateStats();
            updatePlatformStats();
            updateRecentTickets();
            updateQuickStats();
            updateChart();
            
            // Close form and show notification
            closeSampleTicketForm();
            showNotification('Sample ticket added successfully!', 'success');
        }
        
        // Generate random tickets
        function generateRandomTickets() {
            const sampleIssues = [
                "Food was cold and delivery was late",
                "Wrong order items received",
                "Missing items in the order",
                "Poor quality food",
                "Long delivery time",
                "Damaged packaging",
                "Incorrect billing amount",
                "Food allergy concerns not addressed",
                "Rude delivery staff",
                "Payment issues"
            ];
            
            const branches = Object.keys(branchNumbers);
            const platforms = ["Noon", "Careem"];
            
            for (let i = 0; i < 5; i++) {
                const randomIssue = sampleIssues[Math.floor(Math.random() * sampleIssues.length)];
                const randomBranch = branches[Math.floor(Math.random() * branches.length)];
                const randomPlatform = platforms[Math.floor(Math.random() * platforms.length)];
                const randomCompensation = Math.floor(Math.random() * 100) + 10;
                const randomOrderId = `NC${Math.floor(Math.random() * 900000) + 100000}`;
                
                const newTicket = {
                    id: Date.now() + i,
                    orderId: randomOrderId,
                    orderDate: new Date(Date.now() - Math.floor(Math.random() * 30) * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                    branch: randomBranch,
                    platform: randomPlatform,
                    issue: randomIssue,
                    compensation: randomCompensation,
                    evidence: 'None',
                    status: 'Open',
                    dateCreated: new Date().toISOString().split('T')[0],
                    files: []
                };
                
                tickets.unshift(newTicket);
            }
            
            filteredTickets = [...tickets];
            localStorage.setItem('crispyTickets', JSON.stringify(tickets));
            
            renderTickets();
            updateStats();
            updatePlatformStats();
            updateRecentTickets();
            updateQuickStats();
            updateChart();
            
            showNotification('5 random tickets generated successfully!', 'success');
        }
        
        // Show notification
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            const icon = notification.querySelector('i');
            
            // Set message
            notificationText.textContent = message;
            
            // Set icon based on type
            icon.className = type === 'success' ? 'bi bi-check-circle-fill' : 
                            type === 'error' ? 'bi bi-exclamation-circle-fill' : 
                            'bi bi-info-circle-fill';
            
            // Show notification
            notification.classList.add('show');
            
            // Hide after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>
